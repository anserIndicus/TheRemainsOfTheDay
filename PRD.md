# TheRemainsOfTheDay - 浏览器信息收集与回顾插件 PRD

## 一、概述

### 1.1 产品背景
在信息爆炸的时代，用户每天在浏览器中会浏览大量图文内容，并进行各类输入输出操作。这些信息往往难以系统回顾与整理。本插件旨在帮助用户自动收集浏览器内的图文输入输出信息，生成日报及星期维度日程表，方便用户回顾信息、积累知识。

### 1.2 产品目标
开发一款浏览器插件，能在不干扰用户正常操作的前提下，自动收集用户在浏览器中的信息，通过特定处理生成按时间维度整理的星期日程表和日报，帮助用户清晰回顾浏览历史，发现有价值信息，提升信息管理能力。

### 1.3 产品定位
面向学生、知识工作者等需要高效管理浏览及输入信息、注重知识积累与回顾的用户群体。

## 二、功能需求

### 2.1 信息收集
#### 2.1.1 记录内容
1. 浏览图文：记录浏览器中页面的前端文字，如标题、正文、按钮文字等，同时识别并记录与正文紧密相关的图片。
2. 用户输入输出：监测用户在浏览器内的手动输入、复制粘贴操作，记录相应文字内容。

#### 2.1.2 重要程度标记
依据用户在页面或输入区域的停留时长标记内容重要程度：
- 停留超过默认阈值（如180秒）标记为"重要"
- 停留超过更长阈值（如600秒）标记为"非常重要"
注：重要程度仅与页面停留时长相关，与内容类型（工作、学习、娱乐等）无关。具体时长阈值可在设置中自定义。

#### 2.1.3 开关设置
1. 默认设置：
   - 正常浏览器默认开启信息收集
   - 隐私浏览器默认关闭
2. 手动设置：
   - 支持添加特定站点到默认关闭名单
   - 支持单页面关闭记录
   - 提供批量关闭同域名页面选项

#### 2.1.4 数据传输与存储
1. 实时收集：实时收集用户操作信息
2. 本地存储：收集的数据先临时存于本地浏览器缓存
3. 定时传输：每天00:00将数据加密传输至服务器

### 2.2 信息处理与摘要生成
#### 2.2.1 数据整理
按时间顺序整理当天图文及用户输入输出内容，合并同一页面多次操作记录。

#### 2.2.2 摘要生成
每天调用预训练自然语言处理模型生成摘要，包含主要主题、关键信息及重要用户输入。

#### 2.2.3 日报生成
1. 时机：每天23:00系统通过deepseek接口调用大模型处理当天收集的信息
2. 结构设计：日报为Markdown格式，包含：
   - 摘要：模型生成的内容摘要
   - 关键词：用TF-IDF等算法从当天文本提取
   - 日报正文：按时间顺序记录用户当天浏览页面标题、主要内容、输入输出内容
   - 推荐收藏：依据内容重要性（停留时长）和关键词提取，由大模型筛选推荐值得收藏的内容片段
   - References：当天浏览网址列表

### 2.3 日报查看与收藏
#### 2.3.1 日报查看
1. 查看入口：插件菜单"查看日报"选项
2. 展示方式：
   - 左中部日报展示区
   - 右上角星期维度日程表区
3. 数据可用性：
   - 当天的原始浏览记录实时可查
   - 经过大模型处理的日报内容次日00:00后可用
   - 收藏功能仅对已经过大模型处理的日报内容可用

#### 2.3.2 内容收藏
1. 收藏操作：
   - 仅支持从已经过大模型处理的日报中选择内容收藏
   - 在日报的"推荐收藏"模块中，内容前设复选框
   - 用户勾选后点击"加入收藏夹"按钮即可收藏
2. 收藏夹管理：
   - 支持查看、删除、重命名等操作
   - 支持为收藏内容添加自定义标签
   - 支持按标签、时间等维度筛选

## 三、用户体验需求

### 3.1 可用性
1. 兼容性：支持主流浏览器
2. 性能优化：保证浏览器性能和响应速度

### 3.2 易用性
1. 操作便捷：流程简洁，符合用户习惯
2. 可视化展示：界面简洁直观

## 四、数据结构设计

### 4.1 本地临时存储数据结构
```json
{
    "timestamp": "number",
    "url": "string",
    "content": {
        "text": "string",
        "images": ["string"]
    },
    "inputType": "string",
    "importance": "string"
}
```

### 4.2 服务器存储数据结构
```json
{
    "userId": "string",
    "date": "string",
    "records": [
        {
            "timestamp": "number",
            "url": "string",
            "content": {
                "text": "string",
                "images": ["string"]
            },
            "inputType": "string",
            "importance": "string"
        }
    ]
}
```

### 4.3 日报数据结构
```json
{
    "date": "string",
    "summary": "string",
    "keywords": ["string"],
    "body": "string",
    "recommended": [
        {
            "content": "string",
            "importance": "string"
        }
    ],
    "references": ["string"]
}
```

## 五、非功能需求

### 5.1 安全与隐私
1. 数据加密：全程加密保护用户数据
2. 合规性：符合隐私政策和数据保护要求

### 5.2 可维护性
1. 代码结构：模块化设计，完善注释
2. 日志记录：记录关键操作和错误日志

### 5.3 扩展性
预留音频、视频等内容类型支持接口

## 六、交互设计参考

### 6.1 页面布局设计

#### 6.1.1 插件弹出菜单（Popup）
1. 状态区域
   - 顶部显示当前页面URL
   - 采集状态开关（绿色开启/灰色关闭）
   - 今日采集统计（文本数、图片数、重要内容数）

2. 快捷操作区
   - 查看今日日报
   - 打开收藏夹
   - 设置入口
   - 帮助文档

#### 6.1.2 日报查看页面
1. 左侧时间轴区域
   - 垂直时间轴布局
   - 每个日期节点显示：
     - 日期和星期
     - 内容数量统计
     - 重要内容标记
   - 支持按月份快速跳转
   - 支持展开/收起日报详情

2. 右上角星期维度日程表
   - 7×24网格布局
   - 热力图显示浏览密度
   - 支持展开为详细视图
   - 可选择日期加载对应日报

3. 中部内容区域
   - 日报摘要卡片
   - 关键词标签云
   - 时间线式内容列表
   - 推荐收藏区域
   - 参考链接列表

#### 6.1.3 收藏夹页面
1. 顶部操作栏
   - 视图切换（列表/网格）
   - 搜索框
   - 筛选器（时间、标签、重要度）
   - 排序选项

2. 内容展示区
   - 收藏内容卡片
     - 标题和预览
     - 来源和时间
     - 标签展示
     - 快捷操作（编辑、删除）
   - 支持拖拽排序
   - 分页或无限滚动

#### 6.1.4 设置页面
1. 左侧导航栏
   - 信息采集设置
   - 隐私设置
   - 同步设置
   - 显示偏好
   - 数据管理

2. 右侧设置区域
   - 根据左侧选项显示对应设置项
   - 实时保存设置变更
   - 提供重置选项

### 6.2 交互流程设计

#### 6.2.1 信息采集流程
1. 自动采集模式
   - 页面加载完成后自动开始采集
   - 右上角显示简洁的采集状态指示
   - 采集完成后状态指示自动消失

2. 手动控制流程
   - 点击插件图标显示控制面板
   - 开关采集状态
   - 选择是否将域名加入黑名单
   - 确认后更新状态

#### 6.2.2 内容查看流程
1. 日报查看
   - 点击日期节点展开日报
   - 支持按时间段筛选内容
   - 支持内容搜索
   - 支持标签筛选

2. 星期日程表操作
   - 悬停显示时段概览
   - 点击展开详细视图
   - 支持时间段选择
   - 支持日期范围选择

#### 6.2.3 收藏操作流程
1. 添加收藏
   - 选中推荐内容
   - 点击收藏按钮
   - 弹出标签编辑框
   - 确认保存

2. 管理收藏
   - 编辑标签和备注
   - 移动到不同分类
   - 删除确认机制

### 6.3 视觉设计参考

#### 6.3.1 配色方案
1. 主色调
   - 主色：#2196F3（科技蓝）
   - 辅助色：#4CAF50（成功绿）
   - 警示色：#F44336（错误红）
   - 中性色：#9E9E9E（文本灰）

2. 功能色
   - 重要标记：#FF9800（醒目橙）
   - 链接色：#1976D2（链接蓝）
   - 背景色：#F5F5F5（浅灰底）

#### 6.3.2 字体规范
1. 标题文字
   - 大标题：18px
   - 中标题：16px
   - 小标题：14px

2. 正文文字
   - 主要文本：14px
   - 次要文本：12px
   - 辅助文本：11px

#### 6.3.3 图标设计
1. 功能图标
   - 采集状态：圆形进度指示
   - 重要程度：星形标记
   - 操作按钮：描边风格

2. 状态图标
   - 成功：对勾
   - 错误：叉号
   - 警告：感叹号
   - 提示：问号

### 6.4 响应式设计

#### 6.4.1 弹出菜单
- 宽度：320px
- 高度：480px
- 支持滚动

#### 6.4.2 主界面
- 小屏（<768px）：单列布局
- 中屏（768px-1200px）：双列布局
- 大屏（>1200px）：三列布局

#### 6.4.3 适配策略
1. 小屏幕
   - 隐藏次要信息
   - 折叠导航菜单
   - 简化时间轴显示

2. 大屏幕
   - 展示更多详细信息
   - 并列显示多个内容区域
   - 扩展可视化展示

### 6.5 动效设计

#### 6.5.1 过渡动效
1. 页面切换
   - 淡入淡出：300ms
   - 滑动切换：200ms

2. 展开/收起
   - 内容卡片：250ms
   - 菜单项：150ms

#### 6.5.2 交互反馈
1. 按钮状态
   - 悬停：轻微放大
   - 点击：缩小反馈
   - 加载：旋转动画

2. 操作提示
   - 成功：淡入绿色提示
   - 错误：震动红色提示
   - 警告：闪烁黄色提示
